{"version":3,"file":"scripts/water.bundle.js","mappings":"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","sources":["webpack:///./src/scripts/Water.ts","webpack:///./src/scripts/shaders/Water.Shader.ts","webpack:///webpack/bootstrap","webpack:///webpack/runtime/chunk loaded","webpack:///webpack/runtime/define property getters","webpack:///webpack/runtime/hasOwnProperty shorthand","webpack:///webpack/runtime/make namespace object","webpack:///webpack/runtime/jsonp chunk loading","webpack:///webpack/before-startup","webpack:///webpack/startup","webpack:///webpack/after-startup"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Water = void 0;\nconst three_2 = require(\"three\");\nconst OrbitControls_1 = require(\"three/examples/jsm/controls/OrbitControls\");\nconst GLTFLoader_js_1 = require(\"three/examples/jsm/loaders/GLTFLoader.js\");\nconst Water_Shader_1 = require(\"./shaders/Water.Shader\");\nconst tweakpane_2 = require(\"tweakpane\");\n//\nclass Water {\n    constructor() {\n        this.elapsedTime = 0;\n        this.sizes = {\n            width: 0,\n            height: 0\n        };\n        this.tick = () => {\n            window.requestAnimationFrame(this.tick);\n            this.delta = this.clock.getDelta() * 1000;\n            this.elapsedTime += this.delta;\n            //\n            if (this.sizes.width !== window.innerWidth || this.sizes.height !== window.innerHeight) {\n                this.resize();\n            }\n            // render scene into target\n            this.waterMesh.visible = false;\n            this.renderer.setRenderTarget(this.target);\n            this.renderer.render(this.scene, this.camera);\n            this.mapControls.update();\n            this.renderer.setRenderTarget(null);\n            this.waterMesh.visible = true;\n            this.waterMaterial.uniforms.tDepth.value = this.target.depthTexture;\n            this.waterMaterial.uniforms.cameraNear.value = this.camera.near;\n            this.waterMaterial.uniforms.cameraFar.value = this.camera.far;\n            this.waterMaterial.uniforms.uTime.value = this.elapsedTime;\n            // this.postMaterial.uniforms.tDepth.value = this.target.depthTexture;\n            // this.postMaterial.uniforms.cameraNear.value = this.camera.near;\n            // this.postMaterial.uniforms.cameraFar.value = this.camera.far;\n            this.renderer.render(this.scene, this.camera);\n            // this.renderer.render( this.postScene, this.postCamera );\n            // this.effectComposer.render();\n        };\n        this.init();\n    }\n    ;\n    init() {\n        // Canvas\n        this.canvas = document.querySelector('canvas.webglView');\n        // Scene\n        this.scene = new three_2.Scene();\n        this.scene.background = new three_2.Color('#c7c1b7');\n        // Camera\n        this.camera = new three_2.PerspectiveCamera(45, this.sizes.width / this.sizes.height, 0.1, 100);\n        this.camera.position.set(1, 2, 2);\n        this.scene.add(this.camera);\n        // Controls\n        this.mapControls = new OrbitControls_1.MapControls(this.camera, this.canvas);\n        this.mapControls.enableDamping = true;\n        // Light\n        const light = new three_2.PointLight(0xe9f7ec, 1, 100);\n        light.position.set(5, 5, 5);\n        this.scene.add(light);\n        // Plane\n        this.loadPlane();\n        // Water\n        let waterGeom = new three_2.PlaneGeometry(1.9, 1.9);\n        this.waterMaterial = new Water_Shader_1.WaterMaterial();\n        this.waterMesh = new three_2.Mesh(waterGeom, this.waterMaterial);\n        this.waterMesh.rotation.x = -Math.PI / 2;\n        this.waterMesh.position.set(0, -0.05, 0);\n        this.scene.add(this.waterMesh);\n        // Real water depth\n        // Renderer\n        this.renderer = new three_2.WebGLRenderer({ canvas: this.canvas });\n        this.renderer.setSize(this.sizes.width, this.sizes.height);\n        this.renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));\n        this.scene.add(new three_2.Mesh(new three_2.BoxGeometry(0.2, 0.2, 0.2), new three_2.MeshBasicMaterial({ color: 0xebb734 })));\n        // Create a render target with depth texture\n        this.setupRenderTarget();\n        // Resize\n        window.addEventListener('resize', this.resize());\n        // Debug\n        let props = { waterColor: '#8eb4e6' };\n        const waterTwp = new tweakpane_2.Pane({ title: \"Water\" });\n        // let waterColor = waterTwp.addFolder({ title: 'Water color' });\n        waterTwp.addInput(props, 'waterColor', { view: 'color', alpha: true, label: 'inner color' }).on('change', (ev) => {\n            this.waterMaterial.uniforms.uColor.value.setHex(parseInt(ev.value.replace('#', '0x')));\n        });\n        this.clock = new three_2.Clock();\n        //\n        this.tick();\n    }\n    ;\n    findingDepth() {\n        // Setup post processing stage\n        this.postCamera = new three_2.OrthographicCamera(-1, 1, 1, -1, 0, 1);\n        this.postMaterial = new three_2.ShaderMaterial({\n            vertexShader: `\n            varying vec2 vUv;\n        \n            void main() {\n                vUv = uv;\n                gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n            }\n            `,\n            fragmentShader: `\n            #include <packing>\n        \n            varying vec2 vUv;\n            uniform sampler2D tDiffuse;\n            uniform sampler2D tDepth;\n            uniform float cameraNear;\n            uniform float cameraFar;\n        \n        \n            float readDepth( sampler2D depthSampler, vec2 coord ) {\n                float fragCoordZ = texture2D( depthSampler, coord ).x;\n                float viewZ = perspectiveDepthToViewZ( fragCoordZ, cameraNear, cameraFar );\n                return viewZToOrthographicDepth( viewZ, cameraNear, cameraFar );\n            }\n        \n            void main() {\n                //vec3 diffuse = texture2D( tDiffuse, vUv ).rgb;\n                float depth = readDepth( tDepth, vUv );\n        \n                gl_FragColor.rgb = 1.0 - vec3( pow( depth, 0.2 ) );\n                gl_FragColor.a = 1.0;\n            }\n            `,\n            uniforms: {\n                cameraNear: { value: this.camera.near },\n                cameraFar: { value: this.camera.far },\n                tDiffuse: { value: null },\n                tDepth: { value: null }\n            }\n        });\n        const postPlane = new three_2.PlaneGeometry(2, 2);\n        const postQuad = new three_2.Mesh(postPlane, this.postMaterial);\n        this.postScene = new three_2.Scene();\n        this.postScene.add(postQuad);\n    }\n    ;\n    loadPlane() {\n        // Loading tree\n        this.loader = new GLTFLoader_js_1.GLTFLoader();\n        this.loader.load('resources/models/plane.gltf', (gltf) => {\n            gltf.scene.children[0].scale;\n            this.scene.add(gltf.scene.children[0]);\n        });\n    }\n    ;\n    setupRenderTarget() {\n        if (this.target)\n            this.target.dispose();\n        //\n        this.target = new three_2.WebGLRenderTarget(window.innerWidth, window.innerHeight);\n        this.target.texture.format = three_2.RGBFormat;\n        this.target.texture.minFilter = three_2.NearestFilter;\n        this.target.texture.magFilter = three_2.NearestFilter;\n        this.target.texture.generateMipmaps = false;\n        this.target.stencilBuffer = false;\n        this.target.depthBuffer = true;\n        this.target.depthTexture = new three_2.DepthTexture(window.innerWidth, window.innerHeight);\n        this.target.depthTexture.type = three_2.UnsignedShortType;\n        this.target.depthTexture.format = three_2.DepthFormat;\n    }\n    ;\n    resize() {\n        this.sizes.width = window.innerWidth;\n        this.sizes.height = window.innerHeight;\n        this.camera.aspect = this.sizes.width / this.sizes.height;\n        this.camera.updateProjectionMatrix();\n        const dpr = this.renderer.getPixelRatio();\n        this.target.setSize(window.innerWidth * dpr, window.innerHeight * dpr);\n        this.renderer.setSize(this.sizes.width, this.sizes.height);\n    }\n    ;\n}\nexports.Water = Water;\n;\nexports.default = new Water();\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.WaterMaterial = void 0;\nconst three_4 = require(\"three\");\n//\nclass WaterMaterial extends three_4.ShaderMaterial {\n    constructor() {\n        super();\n        this.vertexShader = `\n        #include <packing>\n\n        varying vec2 vUv;\n        varying vec4 vPos;\n        varying vec3 vPosFoam;\n\n        uniform sampler2D tDiffuse;\n        uniform sampler2D tDepth;\n        uniform float cameraNear;\n        uniform float cameraFar;\n\n        float readDepth( sampler2D depthSampler, vec2 coord ) {\n            float fragCoordZ = texture2D( depthSampler, coord ).x;\n            float viewZ = perspectiveDepthToViewZ( fragCoordZ, cameraNear, cameraFar );\n            return viewZToOrthographicDepth( viewZ, cameraNear, cameraFar );\n        }\n\n        void main() {\n\n            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n            vPos = gl_Position.xyzw;\n\n            vUv = uv;\n\n            vPosFoam = position;\n\n        }\n\n        `,\n            this.transparent = true;\n        this.fragmentShader = `\n        #include <packing>\n        #define PI 3.1415926538;\n\n        varying vec2 vUv;\n        varying float vDepth;\n        varying vec4 vPos;\n        varying vec3 vPosFoam;\n\n        uniform sampler2D tDiffuse;\n        uniform sampler2D tDepth;\n        uniform float cameraNear;\n        uniform float cameraFar;\n        uniform vec3 uColor;\n        uniform vec3 uFoamColor1;\n        uniform vec3 uFoamColor2;\n        uniform vec3 uFoamColor3;\n\n        //\tClassic Perlin 3D Noise\n        //\tby Stefan Gustavson\n        //\n        vec4 permute(vec4 x){return mod(((x*34.0)+1.0)*x, 289.0);}\n        vec4 taylorInvSqrt(vec4 r){return 1.79284291400159 - 0.85373472095314 * r;}\n        vec3 fade(vec3 t) {return t*t*t*(t*(t*6.0-15.0)+10.0);}\n\n        float getPerlinNoise3d( vec3 P ) {\n\n            vec3 Pi0 = floor(P); // Integer part for indexing\n            vec3 Pi1 = Pi0 + vec3(1.0); // Integer part + 1\n            Pi0 = mod(Pi0, 289.0);\n            Pi1 = mod(Pi1, 289.0);\n            vec3 Pf0 = fract(P); // Fractional part for interpolation\n            vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0\n            vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);\n            vec4 iy = vec4(Pi0.yy, Pi1.yy);\n            vec4 iz0 = Pi0.zzzz;\n            vec4 iz1 = Pi1.zzzz;\n\n            vec4 ixy = permute(permute(ix) + iy);\n            vec4 ixy0 = permute(ixy + iz0);\n            vec4 ixy1 = permute(ixy + iz1);\n\n            vec4 gx0 = ixy0 / 7.0;\n            vec4 gy0 = fract(floor(gx0) / 7.0) - 0.5;\n            gx0 = fract(gx0);\n            vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);\n            vec4 sz0 = step(gz0, vec4(0.0));\n            gx0 -= sz0 * (step(0.0, gx0) - 0.5);\n            gy0 -= sz0 * (step(0.0, gy0) - 0.5);\n\n            vec4 gx1 = ixy1 / 7.0;\n            vec4 gy1 = fract(floor(gx1) / 7.0) - 0.5;\n            gx1 = fract(gx1);\n            vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);\n            vec4 sz1 = step(gz1, vec4(0.0));\n            gx1 -= sz1 * (step(0.0, gx1) - 0.5);\n            gy1 -= sz1 * (step(0.0, gy1) - 0.5);\n\n            vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);\n            vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);\n            vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);\n            vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);\n            vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);\n            vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);\n            vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);\n            vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);\n\n            vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));\n            g000 *= norm0.x;\n            g010 *= norm0.y;\n            g100 *= norm0.z;\n            g110 *= norm0.w;\n            vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));\n            g001 *= norm1.x;\n            g011 *= norm1.y;\n            g101 *= norm1.z;\n            g111 *= norm1.w;\n\n            float n000 = dot(g000, Pf0);\n            float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));\n            float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));\n            float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));\n            float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));\n            float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));\n            float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));\n            float n111 = dot(g111, Pf1);\n\n            vec3 fade_xyz = fade(Pf0);\n            vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);\n            vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);\n            float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x);\n            return 2.2 * n_xyz;\n\n        }\n\n        float convertDepth ( float depth ) {\n\n            float viewZ = perspectiveDepthToViewZ( depth, cameraNear, cameraFar );\n            return viewZToOrthographicDepth( viewZ, cameraNear, cameraFar );\n\n        }\n\n        float readDepth( sampler2D depthSampler, vec2 coord ) {\n\n            float fragCoordZ = texture2D( depthSampler, coord ).x;\n            return convertDepth( fragCoordZ );\n\n        }\n\n        void main() {\n\n            vec2 centeredUv = vUv - 0.5;\n            float distanceToCenter = length( centeredUv );\n\n            //\n\n            vec2 vViewportCoord = vPos.xy;\n            vViewportCoord /= vPos.w;\n            vViewportCoord = vViewportCoord * 0.5 + 0.5;\n\n            float depth = readDepth( tDepth, vViewportCoord );\n\n            // vec3 color = uFoamColor1;\n\n            float waterDepth = ( depth - convertDepth( gl_FragCoord.z ) );\n\n            // if ( ( depth - convertDepth( gl_FragCoord.z ) ) < 0.0018 ) {\n\n            //     vec3 mix = mix( uFoamColor1, uFoamColor2, perlinNoise );\n            //     // mix = step( 1.0, mix );\n            //     color = mix;\n\n            // }\n\n            float perlinNoise = getPerlinNoise3d( vec3( centeredUv, 1.0 ) );\n            vec3 foamNoise = vec3( perlinNoise );\n            vec3 color = uColor;\n            float foamDiff = 1.0 - min( ( waterDepth * 2500.0 ), 3.0 );\n            // float foam = perlinNoise + foamDiff;\n            // float foam = step( perlinNoise, sin(foamDiff) );\n            float foam = step( foamDiff - sin( foamDiff * 8.0 ), perlinNoise );\n            // foam = step( foamDiff - foam, perlinNoise );\n\n            //foam = saturate (sin((foamDiff - _Time.y * _FoamLinesSpeed) * 8 * UNITY_PI));\n\n            // color = mix( uColor, ( foamNoise + 1.7 ) / 1.0 * uColor, foamDiff );\n            // color = mix( uColor, ( foamNoise + 1.7 ) * uFoamColor1, foamDiff );\n\n            // vec3 color = smoothstep( waterDepth - 0.8, - waterDepth, foamNoise );\n\n            gl_FragColor.rgba = vec4( color, foam );\n            // gl_FragColor.a *= min( waterDepth, 1.0 );\n\n        }\n        `;\n        this.uniforms = {\n            cameraNear: { value: 0 },\n            cameraFar: { value: 0 },\n            tDiffuse: { value: null },\n            tDepth: { value: null },\n            uColor: { value: new three_4.Color(0x8eb4e6) },\n            uFoamColor1: { value: new three_4.Color(0xc2e3ff) },\n            uFoamColor2: { value: new three_4.Color(0xe6f6ff) },\n            uFoamColor3: { value: new three_4.Color(0xffffff) },\n            uTime: { value: 0 }\n        };\n    }\n}\nexports.WaterMaterial = WaterMaterial;\n;\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t\"scripts/water\": 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = (chunkId) => (installedChunks[chunkId] === 0);\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkIds[i]] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunklive_city\"] = self[\"webpackChunklive_city\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [\"vendor\"], () => (__webpack_require__(\"./src/scripts/Water.ts\")))\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n",""],"names":[],"sourceRoot":""}